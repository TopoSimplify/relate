package main

import (
	"time"
	"fmt"
	"simplex/relate"
	"github.com/intdxdt/geom"
)

func main() {
	// POINT(492.23356771259296 -471.9676869728713)
	//wkt := "LINESTRING ( 109.29167991823921 -370.5295256949482, 135.59232921551876 -389.39738279951825, 173.32804342465897 -368.242512712576, 221.92706930006685 -338.5113439417383, 312.83583534935923 -329.36329201224976, 359.14784824239496 -364.8119932390178, 361.4348612247671 -432.2788762189958, 307.1183028934289 -481.4496553399967, 228.21635500159022 -465.44056446339175, 195.62642000278728 -408.2652399040884, 239.6514199134509 -376.8188113964715, 303.6355381435517 -412.291282735024, 338.5647314010457 -400.83244771137896, 314.05878510111637 -350.1687308679386, 282.1636494109685 -354.96342446841834, 253.8124176863926 -347.6671515981231, 259.2325061043262 -364.55281166937783, 295.1114847359752 -387.11036981714614, 275.671874385812 -406.5499801673093, 262.1510152524443 -428.34308304967357, 233.79978352786844 -427.3007583539171, 185.9066148277057 -410.5522528864605, 165.89525123194954 -437.4246554293331, 167.0387577231356 -475.73212288406637, 125.30077079484415 -496.8869929710086 )"
	//wkt := "LINESTRING ( 439.2018415552474 -535.605758361686, 492.23356771259296 -471.9676869728713, 528.4795996775263 -467.1657594058827, 559.7572907192878 -449.52193369001725, 580.6090847471287 -467.9677514838766, 617.9017163738444 -475.58667622481846, 527.2766115605355 -534.5330939573689, 528.8805957165232 -614.7323017567574, 529.2815917555201 -664.0548145533812, 558.9151990373942 -661.7290375271989, 562.2354462402891 -543.0302000237143, 600 -500, 700 -500, 731.9369699437949 -526.0600476533638, 709.6636449577098 -578.0311392875624, 532.1687632362982 -579.645148344525, 604.1074526323496 -545.5203854258853, 607.4758193599239 -594.2815037679134, 625.5206411147863 -548.5679553222619, 655.7557424551557 -606.391584145621, 692.0859835882786 -599.8954483138705, 671.4346875799362 -539.9866400877274, 633.941557933722 -615.9352898737482, 631.7761793231385 -651.5838377405763, 477.38468438853624 -638.4873071069363, 451.92945583301037 -669.2457082781968 )"
	//wkt := "LINESTRING ( 578.3028099257476 -411.09257045101356, 619.7944787857764 -377.80804488197947, 687.7313871390104 -393.7663790589136, 706.8813881513314 -441.6413815897161, 674.5087673924079 -467.17471627281077, 675.8766246075736 -400.1497127296873, 679.0682914429605 -366.40923475559794, 782.1135349854496 -390.1187598184715, 643.0480514435948 -440.27352437455033, 590.6135248622397 -484.04495525985544, 588.3337628369634 -453.4961441211529, 634.8409081526 -424.77114260267143, 662.1980524559158 -467.630668677866 )"
	//wkt := "LINESTRING ( 624.8694272942178 -418.6983852078049, 628.6690306696782 -426.90552849879964, 635.0523643404518 -430.0971953341865, 650.4027619773124 -415.5067183724181, 655.7222067029571 -425.9936236886891, 647.363079276944 -432.83290976451804, 639.6118883910045 -431.1610842793154, 635.2043484754703 -425.0817188785786, 633.2285547202308 -411.40314672692074, 638.8519677159125 -405.6277495962207, 659.0658576733623 -406.08370200127604, 667.4249850993755 -420.67417896304437, 658.913873538344 -433.2888621695733, 642.8035552263914 -424.77775060854174, 625.6293479693098 -409.27536883666284 )"
	//wkt := "LINESTRING ( 632.8484507303832 -422.87004804422736, 632.9633725716069 -417.52618242732257, 638.7669255534067 -413.4464570638791, 645.2600095825491 -411.78009036613463, 653.1896166269885 -411.8375512867465, 656.0626626575825 -415.40012836468304, 654.5686787216736 -418.4455571571126, 648.9949694223212 -419.0201663632314, 646.696532597846 -415.68743296774244, 647.4435245658005 -411.5502466836871, 649.8568832314994 -410.05626274777825, 654.9709051659567 -410.57341103328514, 661.1192236714278 -412.6420041753128, 663.5900432577386 -414.5956754761167, 664.6243398287525 -419.9970020136334, 662.2684420836654 -425.16848486870254, 657.3842638316556 -425.39832855115003, 657.3842638316556 -420.5716112197522, 662.1535202424416 -418.1582525540532, 666.4630892883325 -417.9284088716057, 669.3935962395384 -420.5716112197522, 669.7958226838216 -424.59387566258374, 666.8078548120038 -429.24821023214594, 662.2684420836654 -430.85711600927857, 654.1089913567785 -430.0526631207122, 650.1441878345588 -425.8580159160451, 647.1562199627411 -426.0303986778807, 646.8114544390698 -428.61614010541524, 650.6613361200657 -431.5466470566211, 655.6029752926873 -432.23617810396365, 657.0969592285962 -429.6504366764291, 656.0626626575825 -426.66246880461136, 651.5232499292439 -423.61704001218175, 646.5816107566224 -423.09989172667485, 643.0190336786858 -424.7087975038075, 643.0764945992977 -427.86914813746085, 644.1682520909234 -429.9952022001004 )"
	//wkt := "LINESTRING ( 648.1631601389414 -406.62426353001473, 653.4495648352342 -402.5933799490914, 662.37425977772 -403.4182145984038, 666.5994965172629 -411.71242805019665, 659.9914906468968 -414.4877905157504, 658.1412490031943 -410.65514711093806, 658.8681296489345 -406.09562306038544, 662.37425977772 -403.4182145984038 )"
	//wkt := "LINESTRING ( 653.3429246988316 -408.2441886357772, 654.1743019683687 -407.5030383567325, 656.5291881127515 -407.592116123161, 655.2546827471836 -406.53990820507585, 655.6251784929882 -405.47288045715845, 655.1064844488617 -404.05017679326863, 660.2786050602945 -406.1990521189356, 656.5291881127515 -407.592116123161, 657.1071614762068 -409.11855859587615, 662.0273449804924 -407.9477920391335, 663.272210686396 -409.99292855597514, 659.9822084636507 -412.52711945727884, 658.1412490031943 -410.65514711093806, 658.0704504152989 -403.24990598233063 )"
	//wkt := "LINESTRING ( 653.1206272513488 -407.4587376546714, 653.9060782324547 -405.57661926598377, 654.9434663207077 -405.60625892564815, 655.5807190034916 -406.31761075759306, 656.173512196779 -407.7106747618185, 656.6922062409055 -408.54058523242094, 657.4035580728505 -408.7184231904071, 658.811441906908 -408.3923869340991, 659.2115773123771 -406.8807642912161, 659.7154515266715 -405.91747535212403, 660.6194611464348 -405.63589858531253, 661.1381551905613 -405.8730158626275, 661.5382905960303 -406.7177461630621, 661.760588043513 -407.47355748450354 )"

	//wkt := "LINESTRING ( 576.3907239332679 366.25347008031974, 582.7009244434172 321.3809331192578, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 689.2731997259393 277.20952954821246, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 944.485753691979 339.61040125968924 )"
	//wkt := "LINESTRING ( 1116.822188351397 303.70029631716943, 1125.0734513117682 424.71881973594765, 1234.4026855366872 483.16526570524394, 1351.2955774752797 490.04131817222, 1425.556944118621 472.1635817580823, 1462.6876274402916 493.479344405708, 1332.7302358144445 542.9869221679354, 1275.6590003385434 503.1058178594744, 1301.1003944663548 439.1585299165973, 1346.4823407483966 417.8427672689716, 1438.6214438058755 409.59150430860035, 1485.3786005813124 375.8988472204178, 1473.0017061407557 321.57803273130713, 1409.0544181978785 349.08224259921127, 1435.871022819085 441.90895090338773, 1551.3887042642823 414.4047410354836, 1512.8828104492165 267.94482348889403 )"
	//wkt := "LINESTRING ( 1121.87551081848 377.81569250105457, 1125.0734513117682 424.71881973594765, 1234.4026855366872 483.16526570524394, 1351.2955774752797 490.04131817222, 1425.556944118621 472.1635817580823, 1462.6876274402916 493.479344405708, 1332.7302358144445 542.9869221679354, 1275.6590003385434 503.1058178594744, 1301.1003944663548 439.1585299165973, 1346.4823407483966 417.8427672689716, 1438.6214438058755 409.59150430860035, 1485.3786005813124 375.8988472204178, 1473.0017061407557 321.57803273130713, 1409.0544181978785 349.08224259921127, 1435.871022819085 441.90895090338773, 1551.3887042642823 414.4047410354836, 1534.8451424238895 351.48012189256104 )"
	//wkt := "LINESTRING ( 1121.87551081848 377.81569250105457, 1125.0734513117682 424.71881973594765, 1234.4026855366872 483.16526570524394, 1351.2955774752797 490.04131817222, 1425.556944118621 472.1635817580823, 1462.6876274402916 493.479344405708, 1332.7302358144445 542.9869221679354, 1275.6590003385434 503.1058178594744, 1301.1003944663548 439.1585299165973, 1389.2795883079636 416.5136602019043, 1468.8760746605697 417.155162022274, 1485.3786005813124 375.8988472204178, 1459.2496012068032 368.33518950674414, 1429.6825755988064 384.150110180789, 1435.871022819085 441.90895090338773, 1551.3887042642823 414.4047410354836, 1534.8451424238895 351.48012189256104 )"
	//wkt := "LINESTRING ( 1059.0633476287983 153.80235253709188, 1046.6864531882413 187.49500962527443, 1058.3757423821005 212.24879850638817, 1080.379110276424 219.1248509733642, 1090.693188976888 248.69187658136116, 1096.8816361971665 276.8836916959629, 1136.7627405056273 296.8242438501934, 1161.516529386741 316.7647960044239, 1189.0207392546452 325.7036642114927, 1244.0291589904534 317.4524012511215, 1288.0358947791 293.3862176167054, 1301.7879997130522 226.00090344034024, 1299.0375787262617 157.9279840172775, 1308.6640521800282 126.98574791588534, 1260.531684911196 80.22859114044832, 1215.8373438758517 61.66324947961302, 1170.45539759381 62.35085472631062, 1140.888371985813 72.66493342677468, 1114.0717673646066 146.92630007011584, 1123.0106355716753 195.7462725856457, 1139.5131614924178 238.3777978808971, 1161.516529386741 267.2572182421964, 1211.0241071489686 267.94482348889403, 1223.4010015895253 241.81582411438512, 1260.531684911196 223.25048245354984, 1254.3432376909175 188.87022011866966, 1258.4688691711033 153.11474729039426, 1244.7167642371512 129.04856365597814, 1218.5877648626422 135.2370108762566, 1182.1446867876691 129.04856365597814, 1137.450345752325 132.48658988946616, 1103.7576886641425 125.61053742249014, 1076.2534787962384 133.8618003828614 )"
	wkt := "LINESTRING ( 1008.1805593731756 124.92293217579254, 1017.807032826942 170.30487845783435, 1068.6898210825645 186.11979913187923, 1162.8917398801364 190.24543061206487, 1240.5911327569654 188.87022011866966, 1277.0342108319385 232.87695590731627, 1252.9680271975224 282.3845336695437, 1165.6421608669268 276.1960864492653, 1139.5131614924178 228.75132442713064, 1178.706660554181 177.18093092481038, 1214.4621333824566 153.11474729039426, 1256.970928733412 152.60470728994028, 1275.6590003385434 186.80740437857685, 1197.2720022150165 228.75132442713064, 1215.8373438758517 256.94313954173236, 1283.222658052217 222.56287720685222, 1351.9831827219773 215.6868247398762, 1365.0476824092318 144.86348433002303, 1329.2922095809563 95.35590656779559, 1285.2854737923096 91.23027508760997, 1256.4060534310104 96.7311170611908, 1212.3993176423637 96.04351181449319 )"
	coordinates := geom.NewLineStringFromWKT(wkt).Coordinates()
	coordinates = append(coordinates, coordinates[0])
	fmt.Println("-------------------------------------------------")
	fmt.Println(geom.NewPolygon(coordinates).WKT())
	fmt.Println("-------------------------------------------------")
	//coordinates = append(coordinates, coordinates[0])
	var t0 =  time.Now()
	loops := relate.SimpleLoops(coordinates)
	fmt.Println("elapsed : ", time.Now().Sub(t0))
	//var cg = geom.NewPolygonFromWKT("POLYGON (( 832.5534124710671 378.9549391085969, 832.5534124710671 397.39520251003603, 847.3056231922184 397.39520251003603, 847.3056231922184 378.9549391085969, 832.5534124710671 378.9549391085969 ))")

	for _, g := range loops {
		fmt.Println(g.WKT())
		//fmt.Println(g.Intersects(cg))
	}

}
