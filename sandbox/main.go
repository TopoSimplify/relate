package main

import (
	"github.com/intdxdt/geom"
	"fmt"
	"simplex/relate"
	"simplex/ctx"
)

func main() {
	//var pwkt = "POLYGON (( 835.3455458000186 380.21382266572084, 835.3455458000186 392.84930542354255, 855.5623182125333 392.84930542354255, 855.5623182125333 380.21382266572084, 835.3455458000186 380.21382266572084 ))"
	//var pwkt ="POLYGON (( 1411.4618989393875 130.50514055799954, 1411.4618989393875 147.89410296466994, 1438.3357499315143 147.89410296466994, 1438.3357499315143 130.50514055799954, 1411.4618989393875 130.50514055799954 ))"
	//var pwkt ="POLYGON (( 144.5093270074935 204.8742766590772, 144.5093270074935 235.1277696233169, 213.66016806861285 235.1277696233169, 213.66016806861285 204.8742766590772, 144.5093270074935 204.8742766590772 ))"
	//var pwkt ="POLYGON (( 143.45129318820491 -206.6990886097708, 143.45129318820491 -196.18884049098398, 152.27990160798586 -196.18884049098398, 152.27990160798586 -206.6990886097708, 143.45129318820491 -206.6990886097708 ))"
	//var pwkt ="POLYGON (( 1027.0655199436912 -350.10312538953565, 1027.0655199436912 -323.14115231719626, 1059.8887915100174 -323.14115231719626, 1059.8887915100174 -350.10312538953565, 1027.0655199436912 -350.10312538953565 ))"
	//----------------two-------------------------
	var pwkt1 ="POLYGON (( 1325.5499207489302 500.9780454813396, 1325.5499207489302 522.3190447986169, 1344.5196979198433 522.3190447986169, 1344.5196979198433 500.9780454813396, 1325.5499207489302 500.9780454813396 ))"
	var pwkt2 ="POLYGON (( 1255.9940711222487 455.1344173182995, 1255.9940711222487 468.571342814363, 1281.2871073501328 468.571342814363, 1281.2871073501328 455.1344173182995, 1255.9940711222487 455.1344173182995 ))"
	var g0 = geom.ReadGeometry(pwkt1)
	var g1 = geom.ReadGeometry(pwkt2)
	var contexts = ctx.NewContexts().Push(ctx.New(g0, -1, 0)).Push(ctx.New(g1, -1, 0))
	//----------------two-------------------------

	//var g = geom.ReadGeometry(pwkt)
	//var contexts = ctx.NewContexts().Push(ctx.New(g, -1, 0))
	//var wkt = "LINESTRING ( 586.1365464176768 340.48547016799586, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 947.4987309748076 338.3020128594936 )"
	//var wkt = "LINESTRING ( 1100 100, 1075.967255784803 170.4648088858804, 1168.6981751960143 134.42594158936475, 1194.7358696939928 161.35526605201318, 1237.701435084921 165.4106157827517, 1200 200, 1400 200, 1300 100, 1200 100, 1300.8788488740295 64.32675372017803, 1300 0, 1353.9478764568807 -7.695497999405725, 1393.5450908661303 19.595865390864958, 1363.9780652581335 35.410786064909814, 1400 100, 1500 100, 1600 100 )"
	//var wkt = "LINESTRING ( -184.33370092860702 170.51113898932573, -235.5790071667459 297.5103761881917, -211.07038244415773 371.0362503559562, -87.26103008104715 419.28056792962565, 13.738969918952847 398.28056792962565, 92.73896991895285 361.28056792962565, 323.66324786685686 335.3873416685552, 440.6362294973913 229.55464400283358, 183.29566991021554 70.24858330601049, 12.61194557965402 153.65994165096788, -83.75769306148223 177.3809615084347, -135.65233442887327 232.9762201035387, -134.82589176588652 284.2307690396577, -99.93633661758557 327.3712351571583, -49.56537790713409 335.58491575571264, 1.3041873102572197 329.93274184266915, 35.65201339721372 302.9762201035387, 49.13027426677897 240.80230706006046, 73.47810035373547 180.3675244513648, 153.21690320522094 153.80071304210654, 226.74277737298547 189.4496217295075, 276.8740552146431 169.39711059284446, 327.73896991895276 234.28056792962565, 293.3224314701781 278.174124212121 )"
	//var wkt = "LINESTRING ( 231.31696746126295 -168.4417854573867, 186.75351543760672 -142.37637012279532, 125.37366642389154 -138.59268080003204, 98.04702131504574 -157.0907174890969, 82.91226402399269 -191.56433131871776, 90.47964266951921 -257.14827957994765, 121.58997710112827 -265.5564780749771, 139.24719394069018 -245.79721161165787, 130.43051435450164 -213.6746310114183, 131.8610207147146 -189.83285834120238, 149.75744205947703 -180.21326335042795, 167.14684426663416 -187.4486810741808, 174.1786808187153 -216.63647446162548, 190.11679483561852 -215.94810695430323, 211.55770099794367 -218.0501565780606, 218.48147950375636 -211.34561416286152, 214.92098039595547 -195.7684305662325, 203.27876650877175 -191.0561058976105, 191.37802460987294 -172.64588470490142, 149.5039324906744 -159.315389323326, 121.84747619322391 -171.7131111118383, 109.818499208087 -203.75621913651048, 112.76136868134732 -235.28696349287102 )"
	//var wkt = "LINESTRING ( 800 -400, 840.0021638548561 -355.1442890183745, 838.9770190849463 -276.20814173531585, 911.7622977485457 -211.62402123099514, 1070.6597370845727 -189.0708362929784, 1173.2829374993098 -215.59072092640855, 1209.6229881620284 -276.5482252638715, 1243.6185194271518 -338.67798930013174, 1245.376908975348 -440.66458309550234, 1136.2690023588032 -466.88506893854833, 1024.5282224386294 -475.08622709782713, 959.8953249291841 -436.02696050261244, 939.1999511343239 -369.04011688525804, 945.5920751555708 -315.16364299189024, 996.8493136510634 -289.5350237441439, 1069.6345923146628 -281.3338655848651, 1138.3192918986229 -302.861905752972, 1175.6274568969047 -342.7808982459225, 1200 -400 )"
	//------------------two-----------------------
	var wkt = "LINESTRING ( 1100 500, 1113.7207423404 450.39197302557125, 1142.1754080967698 419.56608512283736, 1216.4737020161797 383.2073455452538, 1267.8501818540694 371.3512348134331, 1316.855439545595 383.99775292737525, 1357.9566234159067 414.0332334479877, 1377.7168079689413 463.8288985216347, 1376.1359932046985 513.6245635952816, 1358.7470307980282 546.0312662622583, 1303.4185140495315 558.6777843762004, 1289.1911811713467 544.4504514980156, 1287.6103664071038 527.0614890913452, 1300.256884521046 487.5411199852761, 1293.1432180819536 442.4878992043574, 1267.8501818540694 440.90708444011466, 1240.7845244757145 454.7023280373146, 1200 500, 1201.4559617558734 571.3243024901425, 1222.7969610731507 599.7789682465122, 1320.8074764562018 610.8446715962116, 1388.7825113186407 590.2940796610557, 1426.722065660467 537.3367850589232, 1444.1110280671373 458.29604684678503 )"
	//------------------two-----------------------

	var ply = geom.NewLineStringFromWKT(wkt)
	var coords = ply.Coordinates()
	var bln = relate.Homotopy(coords, contexts)
	fmt.Println(bln)
	fmt.Print(geom.NewPolygon(coords).WKT())
}
