package main

import (
	"fmt"
	"github.com/intdxdt/geom"
	"simplex/relate/homotopy"
)

func main() {
	//var wkt = "LINESTRING ( 146 245, 132 317, 198 371, 267 397, 368 376, 447 339, 502 279, 523 214, 492.5217391304348 152.00000000000003, 366.8729756607012 131.37937372134223, 270.5033370195649 155.10039357880905, 218.60869565217388 210.69565217391306, 219.43513831516063 261.950201110032, 254.32469346346159 305.09066722753266, 304.69565217391306 313.304347826087, 355.5652173913044 307.6521739130435, 389.9130434782609 280.69565217391306, 403.3913043478261 218.5217391304348, 427.7391304347826 158.08695652173915, 536.8695652173914 108.08695652173915, 604.9215541470315 156.81201749892313, 642.1943603382012 183.49925740212734, 682 212, 647.5834615512252 255.89355628249535 )"
	//var wkt = "LINESTRING ( 586.1365464176768 340.48547016799586, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 947.4987309748076 338.3020128594936 )"
	//var wkt = "LINESTRING ( 1121.87551081848 377.81569250105457, 1125.0734513117682 424.71881973594765, 1234.4026855366872 483.16526570524394, 1351.2955774752797 490.04131817222, 1425.556944118621 472.1635817580823, 1462.6876274402916 493.479344405708, 1332.7302358144445 542.9869221679354, 1275.6590003385434 503.1058178594744, 1301.1003944663548 439.1585299165973, 1389.2795883079636 416.5136602019043, 1468.8760746605697 417.155162022274, 1485.3786005813124 375.8988472204178, 1459.2496012068032 368.33518950674414, 1429.6825755988064 384.150110180789, 1435.871022819085 441.90895090338773, 1551.3887042642823 414.4047410354836, 1534.8451424238895 351.48012189256104 )"
	//var wkt = "LINESTRING ( 479.4163362448547 -78.20519822147746, 496.14852231799415 -17.551023706346804, 543.2077956486991 6.501493773791212, 563.0772666105522 57.7438136227809, 644.6466737171072 94.34547065777353, 745.0397901559442 88.07090088034623, 819.2888658555006 46.2404356974975, 851.6107446110765 30.95160253248049, 843.2184228280079 -46.86810854688215, 837.8778544206007 -79.6744573352409, 819.2888658555006 -141.99665762532175, 732.4906506010896 -151.40851229146273, 654.0585283832481 -144.0881808844642, 624.777202755254 -125.26447155218227, 600 -100, 605.9534934229721 -45.786587704769694, 640.4636271988223 -17.551023706346804, 689.6144237886696 -53.10691911176822, 700.321236658132 -104.49962088518751, 742.9482668968017 -108.53228547904278, 761.5840200290688 -56.02336867386598, 751.6658215581696 -20.165266509845946, 759.9822012885281 19.077029770156393, 792.1015537856815 17.981650685920048, 931.719270722185 -21.69114319767659, 884.1260868889161 -137.81361110703688 )"
	//var wkt = "LINESTRING ( 600 -660, 620 -660, 620 -680, 640 -680, 640 -670, 610 -670, 610 -690, 630 -690, 630 -650, 600 -650, 600 -664.617910408999, 600 -669.9219161782144, 590 -670, 600 -660 )"
	//var wkt = "LINESTRING ( 640 -650, 640 -640, 650 -640, 650 -650, 630 -650, 630 -660, 650 -660 )"
	//var wkt = "LINESTRING ( 680 -660, 690 -660, 690 -670, 680 -670, 680 -660, 680 -650, 670 -650, 670 -660, 680 -660 )"
	//var wkt = "LINESTRING ( 680 -690, 700 -690, 700 -700, 690 -700, 690 -680, 680 -680, 680 -690 )"
	//var wkt = "LINESTRING ( 660 -700, 670 -700, 670 -710, 660 -710, 660 -690 )"
	//var wkt = "LINESTRING ( 700 -710, 710 -710, 720 -710, 720 -720, 710 -720, 710 -710 )"
	//var wkt = "LINESTRING ( 660 -730, 670 -720, 680 -730, 660 -730, 660 -720, 680 -720, 690 -730, 690 -720, 680 -720, 680 -730 )"
	//var wkt = "LINESTRING ( 586.1365464176768 340.48547016799586, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 947.4987309748076 338.3020128594936 )"
	//var wkt = "LINESTRING ( -1084.4988433252431 521.111081244408, -1135.744149563382 648.1103184432739, -1111.235524840794 721.6361926110385, -987.4261724776833 769.8805101847079, -886.4261724776833 748.8805101847079, -807.4261724776833 711.8805101847079, -576.5018945297793 685.9872839236375, -459.52891289924486 580.1545862579158, -508.5673916043536 549.7974327738009, -522.3807034369273 510.7324330662167, -582.1898624298948 467.6346567330489, -626.3333270792406 476.8947108131565, -708.0889857743063 446.8089546887712, -810.8719409324174 472.0323890119436, -866.2833676464902 508.9733401546588, -879.2000977328564 559.7661352556775, -890.0311219525214 606.6029967461204, -941.0448163876995 632.9893904194884, -959.5152919590571 613.6393683923518, -971.8289423399622 574.9393243380788, -949.8402809454889 522.1665369913428, -977.9857675304147 500.17787559686946, -1018.4449044962456 515.1301653451113, -1035.8174768255094 583.5761623586209, -1034.9910341625227 634.8307112947399, -1000.1014790142217 677.9711774122405, -949.7305203037703 686.1848580107949, -898.8609550863789 680.5326840977514, -864.5131289994224 653.5761623586209, -851.0348681298572 591.4022493151426, -826.6870420429007 530.967466706447, -746.9482391914153 504.4006552971888, -673.4223650236506 540.0495639845897, -623.2910871819931 519.9970528479266, -572.4261724776834 584.8805101847079, -606.842710926458 628.7740664672033 )"
	//var wkt = "LINESTRING ( 1064.223969183536 346.09109784489226, 1084.3638181660588 303.065056836775, 1127.7943164483527 272.9049885851819, 1211.0361048227496 269.28578039499075, 1296.2805939425327 261.60717610728614, 1382.8432887423473 310.5598724768364, 1393.5890025795657 433.5385975027798, 1348.566016050014 458.6910090149953, 1312.996148800428 452.64208876894577, 1293.892657534262 433.5385975027798, 1298.2543444641735 374.34255159516044, 1296.466066012829 347.51837482499263, 1248.521865777118 346.9759027029653, 1231.6379900276095 413.9407365384392, 1204.942026326177 414.4351062366138, 1222.8515493882073 334.4392365595439, 1294.2778931971466 319.95469505766715, 1326.7267831479849 352.34875962157446, 1332.1593426241204 387.86303954471634, 1328.8011206839021 424.76701978354214, 1343.7404051297592 434.56295441372083, 1360.7548769658429 425.1808200738322, 1358.9639246596398 383.39193292909414, 1354.5980297003327 332.01872235830433, 1317.1995450683573 304.2714595668387, 1252.0537976449164 292.20743226620147, 1170.9139325083188 322.49955451819017, 1140.467743302867 368.467330377402, 1133.8263300986714 401.9900807020003, 1193.0023442848233 470.55161183097636, 1290.0844079604103 514.8849299917738, 1453.0107943084788 448.89427980176106, 1483.683121817151 374.24281791053465 )"
	//var wkt = "LINESTRING ( 1636.5675019621372 701.8202680514876, 1700 600, 1747.099108459969 524.9696976549563, 1919.2126100065934 517.0745829051111, 2083.4309968033726 491.8102157056067, 2222.385016400647 532.8648124048015, 2302.9151868490676 668.660786102138, 2312.3893245488816 772.876300800094, 2310.8103015989127 836.0372187988552, 2223.964039350616 878.6708384480189, 2148.170937752103 840.7742876487622, 2148.170937752103 783.9294614498772, 2149.747502910075 701.7082620480319, 2179.7513967514833 641.8173959526645, 2145.0128918521646 578.6564779539033, 2094.4841574531556 583.3935468038104, 2017.1120329046732 614.974005803191, 1995.0057116051069 750.7699795005275, 1931.8447936063458 847.0903794486384, 1838.682439558173 873.9337695981118, 1797.627842858978 854.9854941984835, 1762.8893379596595 783.9294614498772, 1766.0473838595976 725.5056123010231, 1781.8376133592878 684.4510156018283, 1854.4726690578632 603.9208451534078, 1884.4741051072747 629.1852123529122, 1833.9453707082657 720.768543451116, 1840.261462508142 788.6665302997842, 1878.1580133073987 779.19239259997, 1913.9024098461164 764.03140041602, 1931.8447936063458 717.6104975511779, 1939.7399083561909 652.8705566024477, 1961.8462296557573 594.4467074535936, 1952.372091955943 551.8130878044299, 1876.5789903574296 542.3389501046156, 1800 600, 1699.7284199608982 766.5602090002178, 1770.7844527095046 946.5688252966872, 2015.5330099547043 948.1478482466562, 2397.6565638472093 881.828884347957, 2404.2598790456095 701.6527125059058 )"
	//var wkt = "LINESTRING ( 2760.5810963473778 357.1457867036501, 2762.318332754234 433.09085942622903, 2613.072307237312 511.89276089916365, 2442.3348540459538 488.0133968164562, 2393.3821576764035 415.1813363641985, 2386.2183484515913 335.18546668712855, 2406.5158079218922 281.4568975010368, 2475.7659637617444 273.0991200720892, 2490.093582211369 332.7975302788578, 2490.093582211369 413.9873681600631, 2522.3307237230238 436.6727640386352, 2562.9256426636266 406.82355893525084, 2559.3437380512205 337.57340309539927, 2570.089451888439 296.9784841547966, 2600 300, 2596.356752379417 378.16832203600194, 2601.1326251959586 442.642605059312, 2630.9818302993426 464.13403273374877, 2677.546590260622 446.2245096717182, 2714.5596045888187 392.4959404856264, 2734.85706405912 311.3061026044211, 2700 300, 2679.934526668893 326.8276892581809, 2673.964685648216 380.55625844427266, 2654.86119438205 415.1813363641985, 2632.175798503478 393.68990868976175, 2646.5034169531027 343.54324411607615, 2640.5335759324257 306.5302297878796, 2649.706342529288 255.30897896715106, 2622.624052870395 238.47404215216338, 2564.119610867762 237.280073948028, 2435.1710448211415 228.9222965190804, 2264.433591629783 259.96546982660004, 2239.3602593429405 355.48292615742986 )"
	//var wkt = "LINESTRING ( 2928.2625100929454 886.54200581398, 2916.3475413726314 734.3490037229385, 3400 700, 3420.58848954695 966.8691862454253, 3300 1000, 3216.7806468865097 972.7823283194554, 3213.9967598323565 822.4756669781709, 3263.8746011085045 820.840335655056, 3264.815498887329 933.2858285908165, 3340.45070568638 943.718270907927, 3332.631528390899 776.3878767846165, 3098.088278788749 779.7078901532545, 3096.475674821984 1057.6920079540696, 3502.42647476287 1038.9295760240288, 3498.9454337661705 852.8954491992829 )"
	//var wkt = "LINESTRING ( 1314.2884808278682 154.43121440225497, 1381.2487081104396 88.6884457975485, 1548.0405469779357 74.07894166316929, 1703.8752577446473 137.38679291214586, 1695.3530469995928 265.219954087964, 1628.3928197170214 307.8310078132367, 1596.738894092533 264.0024954100991, 1618.6531502941018 143.47408630147055, 1534.981920260858 148.62167865883993, 1527.3437494542318 244.52315656426012, 1466.4774737023915 235.82724091607128, 1481.0803196953643 133.7344168785511, 1417.7724684463876 115.47253671057706, 1361.7693692646008 187.3025987046082, 1444.853674279959 319.9129557369496, 1538.300877555016 361.3991896392938, 1629.367943750651 347.94891505136565, 1711.180009811837 365.0515656728886, 1812.2290800746264 192.17243341606792 )"
	//var wkt = "LINESTRING ( 714.2630700679713 -108.56447297739959, 753.3062141186098 45.24185207057001, 823.110623178842 87.83437285308467, 900.0137857028269 29.86121956577305, 942.6063064853415 -121.5788543276124, 1039.6226038232917 -187.83388665596854, 1226.5564450354393 -194.932640119721, 1325.9389935279735 -86.08508700885018, 1317.657114486929 73.63686592557978, 1192.2458032939692 136.34252152205968, 1100 100, 1056.1863619053806 49.97435437973831, 1098.460630680849 -28.057944488564427, 1127.7470030846487 -59.427020362562814, 1167.4001661708355 -96.73321720447885, 1200 -100, 1217.0914404171026 -82.53571027697396, 1176.8651707891722 -32.84443603070686, 1129.5401476974891 10.931210329099871, 1139.0051523158259 54.706856688906605, 1198.1614311804294 72.45374034828771, 1254.951458890449 35.77684745223342, 1266.7827146633697 -24.562556989662344, 1265.5995890860777 -83.71883585426603, 1217.0914404171026 -139.32573798699352, 1095.229505956019 -134.59323567782522, 1007.6782132364056 -43.492566226335526, 987.5650784224404 77.186242657456, 1118.8920175018604 184.8506701910347, 1409.9409095157107 186.0337957683268, 1459.6321837619778 126.8775169037231, 1510.5065835855369 68.90436361641149, 1522.3378393584578 -48.22506853550382 )"
	//var wkt = "LINESTRING ( 1200 1600, 1200 1400, 1400 1400, 1400 1800, 1600 1800, 1600 1400, 1900 1400, 1900 1700, 1800 1700, 1800 1500, 1700 1500, 1700 1800, 2000 1800, 2000 1400, 2300 1400, 2300 1700, 2200 1700, 2200 1500, 2100 1500, 2100 1800, 2400 1800, 2400 1400, 2600 1400, 2600 1600 )"
	var wkt = "LINESTRING ( 1636.5675019621372 701.8202680514876, 1700 600, 1747.099108459969 524.9696976549563, 1919.2126100065934 517.0745829051111, 2083.4309968033726 491.8102157056067, 2222.385016400647 532.8648124048015, 2302.9151868490676 668.660786102138, 2312.3893245488816 772.876300800094, 2310.8103015989127 836.0372187988552, 2223.964039350616 878.6708384480189, 2148.170937752103 840.7742876487622, 2148.170937752103 783.9294614498772, 2149.747502910075 701.7082620480319, 2179.7513967514833 641.8173959526645, 2145.0128918521646 578.6564779539033, 2094.4841574531556 583.3935468038104, 2017.1120329046732 614.974005803191, 1995.0057116051069 750.7699795005275, 1931.8447936063458 847.0903794486384, 1838.682439558173 873.9337695981118, 1797.627842858978 854.9854941984835, 1762.8893379596595 783.9294614498772, 1766.0473838595976 725.5056123010231, 1781.8376133592878 684.4510156018283, 1854.4726690578632 603.9208451534078, 1884.4741051072747 629.1852123529122, 1833.9453707082657 720.768543451116, 1840.261462508142 788.6665302997842, 1878.1580133073987 779.19239259997, 1913.9024098461164 764.03140041602, 1931.8447936063458 717.6104975511779, 1939.7399083561909 652.8705566024477, 1961.8462296557573 594.4467074535936, 1952.372091955943 551.8130878044299, 1876.5789903574296 542.3389501046156, 1800 600, 1699.7284199608982 766.5602090002178, 1770.7844527095046 946.5688252966872, 2015.5330099547043 948.1478482466562, 2397.6565638472093 881.828884347957, 2404.2598790456095 701.6527125059058 )"
	var coordinates = geom.NewLineStringFromWKT(wkt).Coordinates()
	//coordinates = reverseCoordinates(coordinates)

	var poly = geom.NewPolygon(coordinates)
	fmt.Println(poly.WKT())
	var intersections = homotopy.SimpleDeformation( coordinates)

	for _, o := range intersections {
		fmt.Println(o.pt.WKT())
	}
}

