package main

import (
	"fmt"
	"simplex/relate"
	"github.com/intdxdt/geom"
	"simplex/pln"
)

func main() {
	//var wkt = "LINESTRING ( 146 245, 132 317, 198 371, 267 397, 368 376, 447 339, 502 279, 523 214, 492.5217391304348 152.00000000000003, 366.8729756607012 131.37937372134223, 270.5033370195649 155.10039357880905, 218.60869565217388 210.69565217391306, 219.43513831516063 261.950201110032, 254.32469346346159 305.09066722753266, 304.69565217391306 313.304347826087, 355.5652173913044 307.6521739130435, 389.9130434782609 280.69565217391306, 403.3913043478261 218.5217391304348, 427.7391304347826 158.08695652173915, 536.8695652173914 108.08695652173915, 604.9215541470315 156.81201749892313, 642.1943603382012 183.49925740212734, 682 212, 647.5834615512252 255.89355628249535 )"
	//var wkt = "LINESTRING ( 586.1365464176768 340.48547016799586, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 947.4987309748076 338.3020128594936 )"
	//var wkt = "LINESTRING ( 1121.87551081848 377.81569250105457, 1125.0734513117682 424.71881973594765, 1234.4026855366872 483.16526570524394, 1351.2955774752797 490.04131817222, 1425.556944118621 472.1635817580823, 1462.6876274402916 493.479344405708, 1332.7302358144445 542.9869221679354, 1275.6590003385434 503.1058178594744, 1301.1003944663548 439.1585299165973, 1389.2795883079636 416.5136602019043, 1468.8760746605697 417.155162022274, 1485.3786005813124 375.8988472204178, 1459.2496012068032 368.33518950674414, 1429.6825755988064 384.150110180789, 1435.871022819085 441.90895090338773, 1551.3887042642823 414.4047410354836, 1534.8451424238895 351.48012189256104 )"
	//var wkt = "LINESTRING ( 479.4163362448547 -78.20519822147746, 496.14852231799415 -17.551023706346804, 543.2077956486991 6.501493773791212, 563.0772666105522 57.7438136227809, 644.6466737171072 94.34547065777353, 745.0397901559442 88.07090088034623, 819.2888658555006 46.2404356974975, 851.6107446110765 30.95160253248049, 843.2184228280079 -46.86810854688215, 837.8778544206007 -79.6744573352409, 819.2888658555006 -141.99665762532175, 732.4906506010896 -151.40851229146273, 654.0585283832481 -144.0881808844642, 624.777202755254 -125.26447155218227, 600 -100, 605.9534934229721 -45.786587704769694, 640.4636271988223 -17.551023706346804, 689.6144237886696 -53.10691911176822, 700.321236658132 -104.49962088518751, 742.9482668968017 -108.53228547904278, 761.5840200290688 -56.02336867386598, 751.6658215581696 -20.165266509845946, 759.9822012885281 19.077029770156393, 792.1015537856815 17.981650685920048, 931.719270722185 -21.69114319767659, 884.1260868889161 -137.81361110703688 )"
	//var wkt = "LINESTRING ( 600 -660, 620 -660, 620 -680, 640 -680, 640 -670, 610 -670, 610 -690, 630 -690, 630 -650, 600 -650, 600 -664.617910408999, 600 -669.9219161782144, 590 -670, 600 -660 )"
	//var wkt = "LINESTRING ( 640 -650, 640 -640, 650 -640, 650 -650, 630 -650, 630 -660, 650 -660 )"
	//var wkt = "LINESTRING ( 680 -660, 690 -660, 690 -670, 680 -670, 680 -660, 680 -650, 670 -650, 670 -660, 680 -660 )"
	//var wkt = "LINESTRING ( 680 -690, 700 -690, 700 -700, 690 -700, 690 -680, 680 -680, 680 -690 )"
	//var wkt = "LINESTRING ( 660 -700, 670 -700, 670 -710, 660 -710, 660 -690 )"
	//var wkt = "LINESTRING ( 700 -710, 710 -710, 720 -710, 720 -720, 710 -720, 710 -710 )"
	//var wkt = "LINESTRING ( 660 -730, 670 -720, 680 -730, 660 -730, 660 -720, 680 -720, 690 -730, 690 -720, 680 -720, 680 -730 )"
	var wkt = "LINESTRING ( 586.1365464176768 340.48547016799586, 586.9077247835168 292.6344641285775, 604.4360595339316 263.18686174788064, 652.8142634450764 237.2449263172667, 751.674071437416 228.8313256370676, 867.3610807901538 247.7619271675156, 890.4984826607014 329.09340040944033, 876.4758148603695 392.19540551093365, 827.396477559208 420.24074111159734, 799.3511419585443 413.930540601448, 797.2477417884945 390.79313873090047, 826.6953441691915 366.25347008031974, 846.327079089656 353.63306906002106, 856.8440799399049 326.28886684937396, 849.8327460397389 298.94466463872686, 822.4885438290919 288.42766378847796, 788.8341411082954 302.45033158880983, 775.5126066979802 355.03533584005424, 761.4899388976484 381.67840466068475, 734.1457366870012 379.57500449063497, 717.318535326603 331.1968005794901, 717.318535326603 294.0367309086107, 659.1244639552258 294.0367309086107, 631.0791283545622 371.1614038104359, 650.0097298850101 447.58494332224444, 688.5720663359227 481.9404794330575, 761.4899388976484 502.9744811335553, 837.913478409457 498.06654740343913, 900.3143501209337 467.91781163272566, 931.8653526716803 420.24074111159734, 947.2902872520453 370.4602704204193, 947.4987309748076 338.3020128594936 )"
	var coordinates = geom.NewLineStringFromWKT(wkt).Coordinates()
	var segs = pln.New(coordinates).Segments()
	for _, s := range segs {
		fmt.Println(s.WKT())
	}
	var loops = relate.SimpleLoops(coordinates, false)
	for _, g := range loops {
		fmt.Println(g.WKT())
	}
}
